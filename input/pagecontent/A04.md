
Shared Patient Records has two main catgeories:

- [Patient Summary](StructureDefinition-PatientSummary.html) which is often presented as a clinical document and this is broken down into document sections 
- **Patient Record Detail** which gives deeper insight into the patient's health and is often queryable.

<figure>
{%include shared-patient-records-mindmap.svg%}
<p id="fX.X.X.X-X" class="figureTitle">Shared Patient Records Overview</p>
</figure>
<br clear="all">

Most electronic patient records (EPR) are structured similarly around the entities listed under Patient Record Detail.

## Interfaces

Virtually uses a variety of interfaces to access data for both the Patient Summary and Patient Record Detail. Due to information governance such as user type (patient, pharmacist, GP, admin, etc) and organisation/care setting, which interfaces can be used varies.  

| Interface                                      | Type    | Access                 | API                                                                                                                    | Notes                                                                                 |
|------------------------------------------------|---------|------------------------|------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------|
| Virtually Healthcare CDR API                   | Detail  | All                    | [OAS](https://pjoxxcgvvf.execute-api.eu-west-2.amazonaws.com/swagger-ui/index.html#/VH%20Clinical%20Data%20Repository) |                                                                                       |
| EMIS IM1 Transaction API                       | Detail  | (local) GP direct care | [OAS](https://pjoxxcgvvf.execute-api.eu-west-2.amazonaws.com/swagger-ui/index.html#/EMIS%20Web)                        | Record entries entered in Virtually will be present (via consultation writeback)      |
| EMIS PFS API                                   | Detail  | Patient only           | [OAS](https://836ix1x1m8.execute-api.eu-west-2.amazonaws.com/swagger-ui/index.html)                                    |                                                                                       |
| IM1 Bulk API                                   | Detail  | Practitioner           |                                                                                                                        | Is mostly used for analytics but can be used to share data such as laboratory reports |
| GP Connect Access Record (html) API            | Summary | Practitioner           | [OAS](https://fubfc00id1.execute-api.eu-west-2.amazonaws.com/swagger-ui/index.html#/GP%20Connect)                      |                                                                                       |
| NHS England Personal Demographic Service (PDS) | Detail  | Practitioner           | [OAS](https://fubfc00id1.execute-api.eu-west-2.amazonaws.com/swagger-ui/index.html#/NHS%20England%20Service)           |                                                                                       | 

All the external interfaces we use are facaded to use HL7 FHIR RESTful APIs to give consistent access to the data and are adapted to use the same [Canonical Data Model](https://www.enterpriseintegrationpatterns.com/patterns/messaging/CanonicalDataModel.html) which is detailed in this implementation guide as [Resource Profiles](artifacts.html#5).
Where practical, we have also followed international best practice in particular:

- Patient Summary 
  - HL7 [International Patient Summary (IPS)](https://build.fhir.org/ig/HL7/fhir-ips/index.html)
  - IHE [Sharing of IPS (sIPS)](https://profiles.ihe.net/ITI/sIPS/index.html)
- Patient Record Detail (note these APIs are similar and may merge in the future)
  - patient record access: HL7 [International Patient Access (IPA)](https://build.fhir.org/ig/HL7/fhir-ipa/)
  - practitioner record access: IHE [Query for Existing Data for Mobile (QEDm)](https://build.fhir.org/ig/IHE/QEDm/branches/master/index.html)

## Canonical Data Model (Resource Profiles)

| Resource profile                                                                                    | VH CDR    | EMIS IM1 Transaction | IM1 Bulk | EMIS PFS | GP Connect (html)                                               | GP Connect (structured) | NHS PDS  | 
|-----------------------------------------------------------------------------------------------------|-----------|----------------------|----------|----------|-----------------------------------------------------------------|-------------------------|----------|
| [AllegyIntolerance](StructureDefinition-AllergyIntolerance.html)                                    | &#10003;  | &#10003;             |          | &#10003; | [Patient Summary](StructureDefinition-PatientSummary.html) only |                         |          |
| [Binary](StructureDefinition-Binary.html) (documents)                                               | &#10003;  | &#10003;             |          | &#10003; |                                                                 |                         |          |
| Condition                                                                                           |           | &#10003;             |          | &#10003; | [Patient Summary](StructureDefinition-PatientSummary.html) only |                         |          |
| DiagnosticReport (Laboratory reports)                                                               |           |                      |          |          |                                                                 |                         |          |
| [DocumentReference](StructureDefinition-DocumentReference.html) (index of documents)                | &#10003;  | &#10003;             |          | &#10003; |                                                                 |                         |          |
| [Encounter](StructureDefinition-Encounter.html)                                                     | &#10003;  | Inc in Composition   |          | &#10003; | [Patient Summary](StructureDefinition-PatientSummary.html) only |                         |          |
| Composition ([Consultation Note](StructureDefinition-ConsulationNote.html))                         | generated | &#10003;             |          |          |                                                                 |                         |          |
| [Immunization](StructureDefinition-Immunization.html)                                               |           | &#10003;             |          | &#10003; | [Patient Summary](StructureDefinition-PatientSummary.html) only |                         |          |
| [MedicationRequest](StructureDefinition-MedicationRequest.html) (prescriptions)                     |           | &#10003;             |          | &#10003; | [Patient Summary](StructureDefinition-PatientSummary.html) only |                         |          |
| [Observation](StructureDefinition-Observation.html)                                                 | &#10003;  | &#10003;             |          | &#10003; | [Patient Summary](StructureDefinition-PatientSummary.html) only |                         |          |
| [Patient](StructureDefinition-Patient.html) (demographics)                                          | &#10003;  | &#10003;             |          | &#10003; |                                                                 |                         | &#10003; |
| [QuestionnaireResponse](StructureDefinition-QuestionnaireResponse.html) Templates/Forms/Assessments | &#10003;  |                      |          |          |                                                                 |                         | &#10003; |
| ServiceRequest (referrals and laboratory orders)                                                    |           |                      |          |          |                                                                 |                         |          |

### Templates/Forms/Assessments

Are normally persisted as Observations, where the questions and answers are stored as individual Observations (code = the question and value = the answer). For more details on this pattern see [FHIR Structured Data Capture](https://build.fhir.org/ig/HL7/sdc/index.html).
Where the questions are not clinically coded (and there is no need for being able to query the questions), then these templates will often be persisted as is (i.e. FHIR QuestionnaireResponse).

> Storing questions and answers as Observations is a good practice for clinical data, as it allows the data to be reused and is searchable in other contexts. UI/Data Capture focused persitence (i.e. Forms/Templates/Assessments/FHIR QuestionnaireResponse) is considered an architecture antipattern.

## Use Cases

### Practitioner access—local GP Surgery

<figure>
{%include shared-patient-record-usecase-local-sequence.svg%}
<p id="fX.X.X.X-X" class="figureTitle">Use Case: Local GP Surgery with EMIS IM1</p>
</figure>
<br clear="all">


### Practitioner access—out-of-area GP Surgery

<figure>
{%include shared-patient-record-usecase-outofarea-sequence.svg%}
<p id="fX.X.X.X-X" class="figureTitle">Use Case: Out of area GP Surgery</p>
</figure>
<br clear="all">

### Patient access

<figure>
{%include shared-patient-record-usecase-patient-sequence.svg%}
<p id="fX.X.X.X-X" class="figureTitle">Use Case: Patient registered at EMIS practice</p>
</figure>
<br clear="all">
